// Copyright 2016, the Dart project authors.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//     http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

/**
 * Created by stanm on 6/20/16.
 */
public class InvokeVirtual2 {

    private static class R0 {
        public int getInteger() {
            return 0;
        }
    }

    private static class R1 extends R0 {
        public int getInteger() {
            return 1;
        }
    }

    private static class R2 extends R1 {
        public int getInteger() {
            return 2;
        }
    }

    private static class R3 extends R2 {
        public int getInteger() {
            return 3;
        }
    }

    private static class R4 extends R3 {
        public int getInteger() {
            return 4;
        }
    }

    private static class R5 extends R4 {
        public int getInteger() {
            return 5;
        }
    }

    private static class R6 extends R5 {
        public int getInteger() {
            return 6;
        }
    }

    private static class R7 extends R6 {
        public int getInteger() {
            return 7;
        }
    }

    private static class R8 extends R7 {
        public int getInteger() {
            return 8;
        }
    }

    private static class R9 extends R8 {
        public int getInteger() {
            return 9;
        }
    }

    private static class A0 extends R9 {
        public int getInteger() {
            return 10;
        }
    }

    private static class A1 extends R9 {
        public int getInteger() {
            return 11;
        }
    }

    private static class A2 extends R9 {
        public int getInteger() {
            return 12;
        }
    }

    private static class A3 extends R9 {
        public int getInteger() {
            return 13;
        }
    }

    private static class A4 extends R9 {
        public int getInteger() {
            return 14;
        }
    }

    private static class A5 extends R9 {
        public int getInteger() {
            return 15;
        }
    }

    private static class A6 extends R9 {
        public int getInteger() {
            return 16;
        }
    }

    private static class A7 extends R9 {
        public int getInteger() {
            return 17;
        }
    }

    private static class A8 extends R9 {
        public int getInteger() {
            return 18;
        }
    }

    private static class A9 extends R9 {
        public int getInteger() {
            return 19;
        }
    }

    private static class A10 extends R9 {
        public int getInteger() {
            return 20;
        }
    }

    private static class B0 extends A0 {
        public int getInteger() {
            return 100;
        }
    }

    private static class B1 extends A0 {
        public int getInteger() {
            return 101;
        }
    }

    private static class B2 extends A0 {
        public int getInteger() {
            return 102;
        }
    }

    private static class B3 extends A0 {
        public int getInteger() {
            return 103;
        }
    }

    private static class B4 extends A0 {
        public int getInteger() {
            return 104;
        }
    }

    private static class B5 extends A0 {
        public int getInteger() {
            return 105;
        }
    }

    private static class B6 extends A0 {
        public int getInteger() {
            return 106;
        }
    }

    private static class B7 extends A0 {
        public int getInteger() {
            return 107;
        }
    }

    private static class B8 extends A0 {
        public int getInteger() {
            return 108;
        }
    }

    private static class B9 extends A0 {
        public int getInteger() {
            return 109;
        }
    }

    private static class B10 extends A1 {
        public int getInteger() {
            return 110;
        }
    }

    private static class B11 extends A1 {
        public int getInteger() {
            return 111;
        }
    }

    private static class B12 extends A1 {
        public int getInteger() {
            return 112;
        }
    }

    private static class B13 extends A1 {
        public int getInteger() {
            return 113;
        }
    }

    private static class B14 extends A1 {
        public int getInteger() {
            return 114;
        }
    }

    private static class B15 extends A1 {
        public int getInteger() {
            return 115;
        }
    }

    private static class B16 extends A1 {
        public int getInteger() {
            return 116;
        }
    }

    private static class B17 extends A1 {
        public int getInteger() {
            return 117;
        }
    }

    private static class B18 extends A1 {
        public int getInteger() {
            return 118;
        }
    }

    private static class B19 extends A1 {
        public int getInteger() {
            return 119;
        }
    }

    private static class B20 extends A2 {
        public int getInteger() {
            return 120;
        }
    }

    private static class B21 extends A2 {
        public int getInteger() {
            return 121;
        }
    }

    private static class B22 extends A2 {
        public int getInteger() {
            return 122;
        }
    }

    private static class B23 extends A2 {
        public int getInteger() {
            return 123;
        }
    }

    private static class B24 extends A2 {
        public int getInteger() {
            return 124;
        }
    }

    private static class B25 extends A2 {
        public int getInteger() {
            return 125;
        }
    }

    private static class B26 extends A2 {
        public int getInteger() {
            return 126;
        }
    }

    private static class B27 extends A2 {
        public int getInteger() {
            return 127;
        }
    }

    private static class B28 extends A2 {
        public int getInteger() {
            return 128;
        }
    }

    private static class B29 extends A2 {
        public int getInteger() {
            return 129;
        }
    }

    private static class B30 extends A3 {
        public int getInteger() {
            return 130;
        }
    }

    private static class B31 extends A3 {
        public int getInteger() {
            return 131;
        }
    }

    private static class B32 extends A3 {
        public int getInteger() {
            return 132;
        }
    }

    private static class B33 extends A3 {
        public int getInteger() {
            return 133;
        }
    }

    private static class B34 extends A3 {
        public int getInteger() {
            return 134;
        }
    }

    private static class B35 extends A3 {
        public int getInteger() {
            return 135;
        }
    }

    private static class B36 extends A3 {
        public int getInteger() {
            return 136;
        }
    }

    private static class B37 extends A3 {
        public int getInteger() {
            return 137;
        }
    }

    private static class B38 extends A3 {
        public int getInteger() {
            return 138;
        }
    }

    private static class B39 extends A3 {
        public int getInteger() {
            return 139;
        }
    }

    private static class B40 extends A4 {
        public int getInteger() {
            return 140;
        }
    }

    private static class B41 extends A4 {
        public int getInteger() {
            return 141;
        }
    }

    private static class B42 extends A4 {
        public int getInteger() {
            return 142;
        }
    }

    private static class B43 extends A4 {
        public int getInteger() {
            return 143;
        }
    }

    private static class B44 extends A4 {
        public int getInteger() {
            return 144;
        }
    }

    private static class B45 extends A4 {
        public int getInteger() {
            return 145;
        }
    }

    private static class B46 extends A4 {
        public int getInteger() {
            return 146;
        }
    }

    private static class B47 extends A4 {
        public int getInteger() {
            return 147;
        }
    }

    private static class B48 extends A4 {
        public int getInteger() {
            return 148;
        }
    }

    private static class B49 extends A4 {
        public int getInteger() {
            return 149;
        }
    }

    private static class B50 extends A5 {
        public int getInteger() {
            return 150;
        }
    }

    private static class B51 extends A5 {
        public int getInteger() {
            return 151;
        }
    }

    private static class B52 extends A5 {
        public int getInteger() {
            return 152;
        }
    }

    private static class B53 extends A5 {
        public int getInteger() {
            return 153;
        }
    }

    private static class B54 extends A5 {
        public int getInteger() {
            return 154;
        }
    }

    private static class B55 extends A5 {
        public int getInteger() {
            return 155;
        }
    }

    private static class B56 extends A5 {
        public int getInteger() {
            return 156;
        }
    }

    private static class B57 extends A5 {
        public int getInteger() {
            return 157;
        }
    }

    private static class B58 extends A5 {
        public int getInteger() {
            return 158;
        }
    }

    private static class B59 extends A5 {
        public int getInteger() {
            return 159;
        }
    }

    private static class B60 extends A6 {
        public int getInteger() {
            return 160;
        }
    }

    private static class B61 extends A6 {
        public int getInteger() {
            return 161;
        }
    }

    private static class B62 extends A6 {
        public int getInteger() {
            return 162;
        }
    }

    private static class B63 extends A6 {
        public int getInteger() {
            return 163;
        }
    }

    private static class B64 extends A6 {
        public int getInteger() {
            return 164;
        }
    }

    private static class B65 extends A6 {
        public int getInteger() {
            return 165;
        }
    }

    private static class B66 extends A6 {
        public int getInteger() {
            return 166;
        }
    }

    private static class B67 extends A6 {
        public int getInteger() {
            return 167;
        }
    }

    private static class B68 extends A6 {
        public int getInteger() {
            return 168;
        }
    }

    private static class B69 extends A6 {
        public int getInteger() {
            return 169;
        }
    }

    private static class B70 extends A7 {
        public int getInteger() {
            return 170;
        }
    }

    private static class B71 extends A7 {
        public int getInteger() {
            return 171;
        }
    }

    private static class B72 extends A7 {
        public int getInteger() {
            return 172;
        }
    }

    private static class B73 extends A7 {
        public int getInteger() {
            return 173;
        }
    }

    private static class B74 extends A7 {
        public int getInteger() {
            return 174;
        }
    }

    private static class B75 extends A7 {
        public int getInteger() {
            return 175;
        }
    }

    private static class B76 extends A7 {
        public int getInteger() {
            return 176;
        }
    }

    private static class B77 extends A7 {
        public int getInteger() {
            return 177;
        }
    }

    private static class B78 extends A7 {
        public int getInteger() {
            return 178;
        }
    }

    private static class B79 extends A7 {
        public int getInteger() {
            return 179;
        }
    }

    private static class B80 extends A8 {
        public int getInteger() {
            return 180;
        }
    }

    private static class B81 extends A8 {
        public int getInteger() {
            return 181;
        }
    }

    private static class B82 extends A8 {
        public int getInteger() {
            return 182;
        }
    }

    private static class B83 extends A8 {
        public int getInteger() {
            return 183;
        }
    }

    private static class B84 extends A8 {
        public int getInteger() {
            return 184;
        }
    }

    private static class B85 extends A8 {
        public int getInteger() {
            return 185;
        }
    }

    private static class B86 extends A8 {
        public int getInteger() {
            return 186;
        }
    }

    private static class B87 extends A8 {
        public int getInteger() {
            return 187;
        }
    }

    private static class B88 extends A8 {
        public int getInteger() {
            return 188;
        }
    }

    private static class B89 extends A8 {
        public int getInteger() {
            return 189;
        }
    }

    private static class B90 extends A9 {
        public int getInteger() {
            return 190;
        }
    }

    private static class B91 extends A9 {
        public int getInteger() {
            return 191;
        }
    }

    private static class B92 extends A9 {
        public int getInteger() {
            return 192;
        }
    }

    private static class B93 extends A9 {
        public int getInteger() {
            return 193;
        }
    }

    private static class B94 extends A9 {
        public int getInteger() {
            return 194;
        }
    }

    private static class B95 extends A9 {
        public int getInteger() {
            return 195;
        }
    }

    private static class B96 extends A9 {
        public int getInteger() {
            return 196;
        }
    }

    private static class B97 extends A9 {
        public int getInteger() {
            return 197;
        }
    }

    private static class B98 extends A9 {
        public int getInteger() {
            return 198;
        }
    }

    private static class B99 extends A9 {
        public int getInteger() {
            return 199;
        }
    }

    static volatile R0[] rs = {new B0(), new B1(), new B2(), new B3(), new B4(), new B5(), new B6(), new B7(), new B8(), new B9(), new B10(), new B11(), new B12(), new B13(), new B14(), new B15(), new B16(), new B17(), new B18(), new B19(), new B20(), new B21(), new B22(), new B23(), new B24(), new B25(), new B26(), new B27(), new B28(), new B29(), new B30(), new B31(), new B32(), new B33(), new B34(), new B35(), new B36(), new B37(), new B38(), new B39(), new B40(), new B41(), new B42(), new B43(), new B44(), new B45(), new B46(), new B47(), new B48(), new B49(), new B50(), new B51(), new B52(), new B53(), new B54(), new B55(), new B56(), new B57(), new B58(), new B59(), new B60(), new B61(), new B62(), new B63(), new B64(), new B65(), new B66(), new B67(), new B68(), new B69(), new B70(), new B71(), new B72(), new B73(), new B74(), new B75(), new B76(), new B77(), new B78(), new B79(), new B80(), new B81(), new B82(), new B83(), new B84(), new B85(), new B86(), new B87(), new B88(), new B89(), new B90(), new B91(), new B92(), new B93(), new B94(), new B95(), new B96(), new B97(), new B98(), new B99()};

    public static void main(String[] args) {
        if (args.length < 2) {
            System.err.println("Usage: ./a.out <outer-loop-iterations> <inner-loop-iterations>");
            return;
        }

        int outerRep, innerRep;
        try {
            outerRep = Integer.parseInt(args[0]);
            innerRep = Integer.parseInt(args[1]);
        } catch (Throwable _) {
            System.err.println("Error: could not parse command line argument.");
            return;
        }

        System.out.println("iteration,rep " + innerRep);
        for (int id = 0; id < outerRep; ++id) {
            System.out.print(id + ",");
            {
                long tm1 = System.nanoTime();
                for (int k = 0; k < innerRep; ++k) {
                    rs[k % 100].getInteger();
                }
                long tm2 = System.nanoTime();
                System.out.println(1.0 * (tm2 - tm1) / innerRep);
            }
        }
    }
}
